var AlbumFullscreen={container:"",cssUrl:"",windowSize:{},frameSize:{},current:0,imgArr:"",imgLeng:0,expandStatus:0,loadedSlide:0,articleId:0,init:function(i){var e=this;this.container=i.container,this.cssUrl=i.cssUrl,1>$("#popupslide").size()&&($("body").append('<div id="popupslide" style="display:none;"></div>'),$("#popupslide").append('<link href="'+this.cssUrl+'/slideshow/slide_show_gal.css" media="screen" rel="stylesheet" type="text/css"/>'),$("#popupslide").append('<div id="slide_show_gal" class="fullscreen"><div class="icon_close"><a href="javascript:;"></a></div><div class="content_gal"><div id="slide_gal" class="slide_gal sh_slide_left"><div id="galleria" class="galleria-container"></div><div class="showthumb"></div><div class="galleria-share-facebook" style="display: none;"></div><div class="galleria-image-nav"><div class="galleria-image-nav-right">&nbsp;</div><div class="galleria-image-nav-left">&nbsp;</div></div></div><div class="clear"></div></div><div class="bg_opacity_slide" style="display:none;"></div><div class="clear"></div><div id="slide_thumbs" style=""><div id="close_thumbs"></div><div class="galleria-thumbnails-container galleria-carousel"><div class="galleria-thumbnails-list slides_container"></div></div><div class="galleria-counter">Tất cả các ảnh (<span class="galleria-total">0</span>) </div></div>')),this.buildImage(),this.resizeBox(),$(window).resize(function(){e.resizeBox()}),$("#popupslide .icon_close").unbind("click").bind("click",function(i){e.close(),e.loadedSlide=0}),$("#slide_show_gal .showthumb").unbind("click").bind("click",function(i){e.showThumb()}),$(document).unbind("keydown").bind("keydown",function(i){39==i.keyCode&&e.showNext(i),37==i.keyCode&&e.showPrev(i),27==i.keyCode&&e.close()}),$("#popupslide .galleria-image-nav-left").unbind("click").bind("click",function(i){e.showPrev(i)}),$("#popupslide .galleria-image-nav-right").unbind("click").bind("click",function(i){e.showNext(i)})},buildImage:function(){var i=$(this.container).find("img"),e=$(this.container).parents(".block").attr("data-block-id"),a=this;$(i).each(function(i){$(this).css("cursor","url("+a.cssUrl+"/slideshow/images/icons/zoom_cursor.png),auto"),$(this).attr("id","vne_slide_image_"+e+"_"+i),$(this).click(function(e){e.preventDefault(),a.showImage(i,e)})})},getImage:function(i){var e=[],a=0;i=$(i.target).parents("."+$(this.container).attr("class")).find("img");var t=document.getElementsByTagName("meta");if(0<t.length)for(var l=0;l<t.length;l++)null!=t[l].getAttribute("name")&&"tt_article_id"==t[l].getAttribute("name").toLowerCase()&&(this.articleId=t[l].getAttribute("content"));var s='<div class="galleria-thumb-item"><div id="galleria-thumb-jcarousellite">';s+="<ul>",$(i).each(function(i){s+='<li class="galleria-image galleria-image-'+i+'"><img rel="'+i+'" src="'+$(this).attr("src")+'"></li>',e[i]=$(this).clone(),a++}),s+="</ul>",s+="</div>",s+='<div class="galleria-thumb-nav-left"></div><div class="galleria-thumb-nav-right"></div></div>',$("#popupslide .galleria-thumbnails-list").html(s),$("#popupslide .galleria-total").text(a),this.imgLeng=e.length,this.imgArr=e},showNext:function(i){i.preventDefault(),this.current<this.imgLeng&&this.showImage(parseInt(this.current)+1)},showPrev:function(i){i.preventDefault(),0!=this.current&&this.showImage(parseInt(this.current)-1)},showImage:function(i,e){e&&(this.getImage(e),$("iframe").hide(),1==device_env&&($("#page").hide(),$("#box_col_left").hide()));var a=this;$("html").css({"overflow-x":"hidden","overflow-y":"hidden"}),$("#popupslide").prepend('<div class="galleria_loading"><img src="'+this.cssUrl+'/slideshow/images/icons/classic-loader.gif" alt="Loading"></div>'),this.current=parseInt(i);var t=this.imgArr[i],l=t.attr("src");l="string"==typeof l&&0>l.toLowerCase().indexOf(".gif")?l.replace("_180x108.","_1200x0."):l.replace("_180x108.","."),$("#galleria").html('<img style="max-width: 100%; max-height: 100%; display: none;" src="'+l+'" />'),t=t.attr("data-component-caption"),l="","undefined"!=typeof t?(t=this.replacetext(t),l='<div id="galleria-info" data-show="1" class="galleria-info"><div class="galleria-info-text"><div class="galleria-info-description"><div class="text-too-lenght show_description_all"><span class="galleria-count-image-thumb">'+(this.current+1)+"/"+this.imgLeng+"  |  </span>"+t+"</div></div></div></div>"):l='<div id="galleria-info" data-show="1" class="galleria-info"><div class="galleria-info-text"><div class="galleria-info-description"><div class="text-too-lenght show_description_all"><span class="galleria-count-image-thumb">'+(this.current+1)+"/"+this.imgLeng+"</div></div></div></div>",$("#galleria").append(l);var s=1,n=setInterval(function(){var i=$(".text-too-lenght").height();(0<i||5<s)&&(30<i&&($(".galleria-info-description").append('<div class="too-length-dot"> ...</div>'),0==a.expandStatus?($("#galleria-info").prepend('<div class="view-more-too-lenght">&nbsp;</div>'),a.showViewMore()):($("#galleria-info").prepend('<div class="view-more-too-lenght show_icon_all">&nbsp;</div>'),$(".too-length-dot").hide()),$("#galleria-info .view-more-too-lenght").click(function(){a.showViewMore()})),clearInterval(n)),s++},100);$("#popupslide").show(),$("#galleria").find("img").load(function(){var i=a.frameSize.height,e=$(this).height();i=i/2-e/2,0>i&&(i=0),$(".galleria_loading").remove(),$(this).css("margin-top",i+"px").fadeIn(500)}),4!=device_env&&this.isTouchEnabled(),0==this.current?$(".galleria-image-nav-left").hide():$(".galleria-image-nav-left").show(),this.current==this.imgLeng-1?$(".galleria-image-nav-right").hide():$(".galleria-image-nav-right").show()},resizeBox:function(){var i=$(window).width(),e=$(window).height();this.windowSize={width:i,height:e},this.frameSize={width:i-80,height:e-60},this.calculator()},calculator:function(){$("#popupslide").find(".galleria-image-nav").css("top",(this.frameSize.height-50)/2),$("#galleria").height(this.frameSize.height)},showViewMore:function(){0==parseInt($("#galleria-info").attr("data-show"))?($("#galleria-info").find(".text-too-lenght").addClass("show_description_all"),$("#galleria-info").find(".view-more-too-lenght").addClass("show_icon_all"),$("#galleria-info").find(".too-length-dot").hide(),$("#galleria-info").find(".galleria-count-image-thumb").hide(),$("#galleria-info").attr("data-show",1),this.expandStatus=1):($("#galleria-info").find(".text-too-lenght").removeClass("show_description_all"),$("#galleria-info").find(".view-more-too-lenght").removeClass("show_icon_all"),$("#galleria-info").attr("data-show",0),$("#galleria-info").find(".too-length-dot").show(),$("#galleria-info").find(".galleria-count-image-thumb").show(),this.expandStatus=0)},isTouchEnabled:function(){var i=this;document.createTouch&&$("#galleria").swipe({swipe:function(e,a,t,l,s){"left"==a&&i.showNext(e),"right"==a&&i.showPrev(e)},tap:function(i,e){jQuery(e).trigger("click")}})},hideThumb:function(){$("#slide_thumbs").animate({bottom:"-250px"},500).hide(),$(".footer_gal li.viewall a").removeClass("hideslideshow"),$(".footer_gal li.viewall a").text("Xem táº¥t cáº£"),$("#thumb-more").css("background-position","right top 0px"),$(".bg_opacity_slide").hide(),$("#galleria-thumb-jcarousellite").find("li").removeAttr("style")},displayThumb:function(){$("#slide_thumbs").css("bottom","-250px").show().animate({bottom:20},500),$(".bg_opacity_slide").show();var i=parseInt($(".galleria-thumb-item").width()/160);if(i=1>i?1:i,$("#galleria-thumb-jcarousellite").find(".galleria-image").removeClass("active"),$("#galleria-thumb-jcarousellite").find(".galleria-image-"+this.current).addClass("active"),i>=this.imgLeng)return $(".galleria-thumb-nav-left").addClass("disabled"),$(".galleria-thumb-nav-right").addClass("disabled"),!1;var e=$("#galleria-thumb-jcarousellite").find("ul");e.addClass("owl-carousel"),e.owlCarousel({autoplay:!1,pagination:!1,nav:!1,rewind:!0,responsive:{1024:{items:8},900:{items:6},720:{items:5},640:{items:5},480:{items:3}}}),$(".galleria-thumb-nav-right").unbind("click").bind("click",function(){e.trigger("next.owl.carousel")}),$(".galleria-thumb-nav-left").unbind("click").bind("click",function(){e.trigger("prev.owl.carousel")})},showThumb:function(){$("#thumb-more").css("background-position","right top -4px"),$("#thumb-more").css("margin-top","6px"),this.displayThumb(),0==this.loadedSlide&&(this.slideThumb(),this.loadedSlide=1)},slideThumb:function(){var i=this;$("#close_thumbs").bind("click",function(){i.hideThumb()}),$("#popupslide #slide_thumbs .galleria-image").find("img").unbind("click").bind("click",function(){i.showImage($(this).attr("rel")),i.hideThumb(),$(".bg_opacity_slide").hide()})},close:function(){$("html").css({"overflow-x":"auto","overflow-y":"auto"}),$("#popupslide").hide(),this.hideThumb(),$("iframe").show(),1==device_env&&($("#page").show(),$("#box_col_left").show())},replacetext:function(i){return(i+"").replace(/\\(.?)/g,function(i,e){switch(e){case"\\":return"\\";case"0":return"\0";case"":return"";default:return e}})}};